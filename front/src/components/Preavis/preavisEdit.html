<div id="preavisEdit" class="preavisEdit" v-if="affaireLoaded">

    <!-- TITRE -->
    <md-toolbar class="justifyTitleBtn">
        <h1>Saisie de préavis pour l'affaire {{ affaire.id }}</h1>
        <md-button class="md-raised md-primary" @click="$router.push({name: 'Preavis'})">Retour</md-button>
    </md-toolbar>

    <md-card>
        <md-card-content>
            <div class="md-layout md-gutter md-alignment-top-space-between">
                <div class="md-layout-item md-size-50">
                    <div class="md-title">Informations générales</div>
                    <br>
                    <table class="tg">
                        <tbody>
                            <tr>
                                <td class="title">Numéro d'affaire</td>
                                <td class="content">{{ affaire.id }}</td>
                            </tr>
                            <tr>
                                <td class="title">Type d'affaire</td>
                                <td class="content">{{ affaire.type_affaire }}</td>
                            </tr>
                            <tr>
                                <td class="title">Cadastre</td>
                                <td class="content">{{ affaire.cadastre }}</td>
                            </tr>
                            <tr>
                                <td class="title">Description</td>
                                <td class="content">{{ affaire.nom }}</td>
                            </tr>
                            <tr>
                                <td class="title">Date de la demande</td>
                                <td class="content">{{ affaire.date_ouverture }}</td>
                            </tr>
                            <tr>
                                <td class="title">Client</td>
                                <td class="content">{{ affaire.client }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="md-layout-item md-size-50">
                    <!-- MAP -->
                    <div id="mapContainer">
                        <!-- <MapHandler ref="mapHandler" /> -->
                    </div>
                </div>
            </div>
        </md-card-content>
    </md-card>


    <md-card>
        <md-card-header>
            <div class="md-title">Documents</div>
        </md-card-header>
        <md-card-content>
            <div class="md-layout md-gutter md-alignment-top-space-between">
                <div class="md-layout-item md-size-65">
                    <md-table v-model="documents" md-sort="filename" md-sort-order="asc" md-fixed-header md-card>
                        <md-table-empty-state md-label="Aucun document"></md-table-empty-state>
                        
                        <md-table-row slot="md-table-row" slot-scope="{ item }">
                            <md-table-cell style="width: 40%;" md-label="Fichier" md-sort-by="filename">{{ item.filename }}</md-table-cell>
                            <md-table-cell style="width: 15%;" md-label="Taille" md-sort-by="size" md-numeric>{{ item.size }}</md-table-cell>
                            <md-table-cell style="width: 25%;" md-label="Modification" md-sort-by="modification_sort">{{ item.modification }}</md-table-cell>
                            <md-table-cell style="width: 20%;" md-label="Actions">
                                <md-button class="md-icon-button md-dense md-primary" @click="downloadFile(item)">
                                    <md-icon>save_alt</md-icon>
                                </md-button>
                            </md-table-cell>
                        </md-table-row>
                    </md-table>
                </div>
                <div class="md-layout-item md-size-30">
                    <md-card>
                        <md-card-header>
                            <div class="md-title">Drag & drop</div>
                        </md-card-header>
                        <md-card-content>
                            <div class="dragdrop">
                                <drop class="drop" @drop="handleDrop" style="height: 200px !important; margin:auto;">
                                    Glissez des documents ici pour les ajouter à la liste
                                    <br>
                                    puis appuyez sur ENREGISTRER pour les charger
                                    <br><br>
                                    <md-icon class="md-size-5x">cloud_upload</md-icon>
                                </drop>
                            </div>
                            <div v-if="droppedFiles.length > 0">
                                <ul>
                                    <li v-for="item in droppedFiles">{{ item.name }} ({{ Math.ceil(item.size/1000) }} ko) <button @click="removeItem(item)" class="md-dense">supprimer</button></li>
                                </ul>
                                <md-button @click="saveFiles" 
                                    style="float: right; margin-bottom: 15px;" 
                                    class="md-dense md-raised md-primary">enregistrer</md-button>
                            </div>
                            <div v-else>
                                <em>Aucun document</em>
                            </div>
                        </md-card-content>
                    </md-card>
                </div>
            </div>
        </md-card-content>
    </md-card>

    <!-- <preavisEditComments :preavis_id="affaire.preavis_id" /> -->
    
    <preavisEditDecision :preavis_id="affaire.preavis_id" />

    <!-- <div class="rightColumn">
            <md-card class="mapHeight">
                <md-card-content>
                    <div class="md-layout md-gutter">
                        <div class="md-layout-item md-size-30">
                            <md-field>
                                <label>Coordonnées</label>
                                <md-input v-model="[affaire.localisation_e | 0, affaire.localisation_n | 0].join(' / ')" readonly></md-input>
                            </md-field>
                        </div>
                        <div style="text-align: right;" class="md-layout-item">
                            <md-button style="background-color: lightgray;" class="md-raised" @click="openSitnTheme('cadastre')">Cadastre</md-button>
                            <md-button style="background-color: lightgray;" class="md-raised" @click="openSitnTheme('sites_pollues')">Sites Pollués</md-button>
                            <md-button style="background-color: lightgray;" class="md-raised" @click="openSitnTheme('amenagement_territoire')">Aménagement du territoire</md-button>
                        </div>
                        <div class="md-layout-item md-size-100" v-if="showMovePointComment">
                            <p style="color: blue; margin-top: 0px;">Pour modifier les coordonnées, déplacer la pastille sur la carte.</p>
                        </div>
                        <div id="mapContainer">
                            <MapHandler ref="mapHandler" />
                        </div>
                    </div>
                </md-card-content>
            </md-card>
        </div> -->

</div>