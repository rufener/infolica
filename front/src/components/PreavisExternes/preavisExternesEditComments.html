<div id="preavisEditComments" class="preavisEditComments">

    <md-card>
        <md-card-header>
            <div class="md-title">
                <md-card-expand-trigger>
                    <md-button class="md-icon-button">
                        <md-icon>keyboard_arrow_down</md-icon>
                    </md-button>
                </md-card-expand-trigger>
                Conversation ({{ conversation.length }}, dont {{ `${conversation.filter(x => x.unread).length} ${conversation.filter(x => x.unread).length > 1? "éléments non lus": "élément non lu"}` }})
            </div>
        </md-card-header>
        <md-card-expand>
            <md-card-expand-content>

                <md-card-content>
                    <div class="md-layout md-gutter md-alignment-top-space-between">
                        <div class="md-layout-item md-size-50">
                            <md-field>
                                <label>Commentaire</label>
                                <md-textarea v-model="commentaire"></md-textarea>
                            </md-field>

                            <div class="md-layout-item" style="float: right;">
                                <md-button class="md-raised md-primary" @click="saveMessage" :disabled="commentaire === '' || commentaire === null">Ajouter le commentaire</md-button>
                            </div>
                        </div>
                        <div class="md-layout-item md-size-50">
                            <md-table v-model="conversation" md-card>
                                <md-table-empty-state md-label="Aucun commentaire"></md-table-empty-state>

                                <md-table-row slot="md-table-row" slot-scope="{ item }">
                                    <md-table-cell style="width: 15% !important;" md-label="Date">{{ item.date }}</md-table-cell>
                                    <md-table-cell style="width: 20% !important;" md-label="Operateur">{{ item.operateur }}</md-table-cell>
                                    <md-table-cell style="width: 60% !important;" md-label="Message">{{ item.message }}</md-table-cell>
                                    <md-table-cell style="width: 5% !important;"><md-button v-if="item.unread === true" class="md-primary md-elevation-2" title="Marquer comme lu" style="min-width: fit-content;" @click="remark_read(item)"><b>Lu</b></md-button></md-table-cell>
                                </md-table-row>
                            </md-table>
                        </div>
                    </div>

                </md-card-content>
            </md-card-expand-content>
        </md-card-expand>
    </md-card>

</div>